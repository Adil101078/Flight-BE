
<%- include('../partials/LayoutHeader')%>
<form id="waitform" asp-controller="flights" asp-action="GetLowFares" method="post" data-ajax="true" data-ajax-complete="onComplete" data-ajax-success="onSuccess" data-ajax-failed="onFailed">
    <div class="flight-loader-info" id="" style="display:block;">
        <div class="cntr-fl-infoset container">
            <div class="loadr-inner-fl">


                <div class="loader-flightloader">
                    <div class="row-title">
                        <div class="title">
                            <span class="txt-blue">Book</span> <span class="txt-orange">with</span>
                            <span class="txt-pink">Confidence</span>
                        </div>
                    </div>

                    <div class="row-title">
                        <div class="title">
                            <span class="tbk__title kl-font-alt fs-xl fw-semibold black"><%=data.Origin%></span>
                            <span class="txt-orange"><i class="fa fa-plane plane-img"></i></span>
                            <span class="tbk__title kl-font-alt fs-xl fw-semibold black"><%=data.Destination%></span>
                        </div>
                    </div>


                </div>





                <ul>
                    <li>
                        <i class="icon-calendar3"></i>
                        <p class="black fs-xxl"> Depart  </p>
                        <div class="dt-fl-info black">
                            <%
                                let date = new Date(data.Departure)
                                let moment = data.moment
                                let Day = moment(date).format('dddd').substring(0,3)
                                let month = moment(date).format('MMMM').substring(0,3)
                            %>
                            <span class="black fs-xxl"><%=Day%>, <%=date.getDate()%> </span>
                            <%=month%> <%=date.getFullYear()%>
                        </div>
                    </li>
                    <% if (data.jType === "Return"){%>
                        <li>
                            <i class="icon-calendar3"></i>
                            <p class="black fs-xxl"> Return  </p>
                            <div class="dt-fl-info black">
                                <%
                                let return_date = new Date(data.ReturnDate)
                                let return_day = moment(return_date).format('dddd').substring(0,3)
                                let return_month = moment(return_date).format('MMMM').substring(0,3)
                            %>
                                <span class="black fs-xxl"> <%=return_day%>, <%=return_date.getDate()%></span>
                                <%=return_month%> <%=return_date.getFullYear()%>
                            </div>
                        </li>
                    <%}%>
                    <li>
                        <i class="icon-user">

                        </i>
                        <p class="black fs-xxl"> Travellers  </p>
                        <div class="dt-fl-info">
                            <span class="black fs-xxl"> <%=data.TotalPassengers%></span>

                        </div>

                    </li>


                </ul>
            </div>


            <div class="loading-bar">
                    <span class="bar-animation"></span>
                </div>

            <div class="loading-flight">

                <div class="notice-message block">
                    <a href="tel:<%=data.contact_us%>">
                        <i class="fa fa-phone fa-rotate-100"></i>

                       <%=data.contact_us%>
                    </a>
                </div>
            </div>

            <div class="loading-flight">

                <div class="tbk__title fs-xxl black"><strong class="txt-orange">LOADING FLIGHTS</strong></div>
            </div>



        </div>


        <!--<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">--><!-- Font Awesome Pro 5.15.4 by fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --><!--<path d="M497.39 361.8l-112-48a24 24 0 0 0-28 6.9l-49.6 60.6A370.66 370.66 0 0 1 130.6 204.11l60.6-49.6a23.94 23.94 0 0 0 6.9-28l-48-112A24.16 24.16 0 0 0 122.6.61l-104 24A24 24 0 0 0 0 48c0 256.5 207.9 464 464 464a24 24 0 0 0 23.4-18.6l24-104a24.29 24.29 0 0 0-14.01-27.6z" /></svg>-->



        <div class="gototop js-top">
            <a href="#" class="js-gotop"><i class="icon-arrow-up2"></i></a>
        </div>




    </div>

</form>

<style>

    /*lodr*/
    .flight-loader-info {
        position: fixed;
        width: 100%;
        height: 100%;
        /*background-color: rgb(0 35 66 / 0.95);*/
        z-index: 99;
        left: 0;
        top: 0;
        /*background-image: url(//cheapfaresus.com/images/loading.jpg);*/
        background-color: #0097cb;
        background-color: #ac7a19;
       
        background-image: -moz-radial-gradient(center center, circle cover, #f8f9fa, #ddd 100%);
        background-image: -webkit-radial-gradient(center center, circle cover, #f8f9fa, #ddd 100%);
        background-image: -o-radial-gradient(center center, circle cover, #f8f9fa, #ddd 100%);
        background-image: -ms-radial-gradient(center center, circle cover, #f8f9fa, #ddd 100%);
        background-image: radial-gradient(center center, circle cover, #f8f9fa, #ddd 100%);
        z-index: 9999;
    }

    .notice-message.block {
        font-size: 4.5em;
        line-height: 0.6666em;
        color: #f5a81f;
        text-transform: uppercase;
        /* letter-spacing: -0.1em; */
        text-shadow: 0 16px 6px rgba(3,121,165,0.6);
        font-weight: 900;
        text-align: center;
    }

    .cntr-fl-infoset {
        /* position: absolute;*/
        margin: auto;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        width: 100%;
        height: fit-content;
        border-radius: 10px;
    }

    .loadr-inner-fl {
        display: block;
        padding: 10px;
    }

    .cntr-fl-infoset ul {
        padding: 0 50px;
        margin: 0;
        display: inline-block;
        width: 100%;
        margin-top: 10px;
    }

    .cntr-fl-infoset li {
        list-style: none;
        float: left;
        border-right: 1px dashed #c3c3c3;
        text-align: center;
        padding: 0 20px;
        width: 33.3%;
        text-shadow: 0 10px 6px rgb(3 121 165 / 60%);
        color: #fff;
    }

        .cntr-fl-infoset li i {
            font-size: 36px;
            color: #fff;
        }

        .cntr-fl-infoset li p {
            color: #fff;
            padding: 10px 0;
            margin: 0;
            font-size: 30px;
        }

    .dt-fl-info {
        font-size: 14px;
        color: #fff;
    }

        .dt-fl-info span {
            display: block;
            font-size: 18px;
            color: #fff;
            font-weight: 600;
        }

    .cntr-fl-infoset li i.icon-airplane.takoff {
        transform: rotate(90deg);
        display: inline-block;
    }

    .cntr-fl-infoset h3 {
        font-size: 1.2em;
        font-weight: 300;
        color: #fff;
        letter-spacing: normal;
        text-transform: none;
        text-shadow: 0 10px 6px rgba(3,121,165,0.6);
        text-align: center;
        margin-bottom: 15px;
    }

    .desti-fl-fare {
        text-align: center;
    }

        .desti-fl-fare p {
            font-size: 42px;
            font-weight: 400;
            color: rgb(255 255 255);
            text-shadow: 0 10px 6px rgb(3 121 165 / 60%);
        }

            .desti-fl-fare p i.icon-arrow-right {
                transform: none;
                margin: 0;
                width: 40px;
                height: 40px;
                border: 1px solid;
                text-align: center;
                line-height: 38px;
                font-size: 16px;
                border-radius: 50px;
                margin-left: 15px;
            }

            .desti-fl-fare p i {
                display: inline-block;
                margin: 0 15px;
                transform: rotate(-45deg);
                font-size: 24px;
                vertical-align: middle;
            }

    .row-title {
        text-align: center;
        margin-top: 20px;
    }

        .row-title .title {
            font-size: 35px;
            font-weight: bold;
        }

    .txt-blue {
        color: #08c0cb;
    }

    .txt-orange {
        color: #f5a81f;
    }

    .txt-pink {
        color: #ee426d;
    }

    .loading-flight {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        flex: 1;
        width: 100%;
        margin-top: 30px;
    }
</style>


    <script>


        onSuccess = function(xhr, data) {
            if (xhr.responseMsg.statusCode == "401") {
                        toastr.error("Authentication failed invalid user name or password.", "Authentication Error");
            }
            else if (xhr.responseMsg.statusCode == "200") {
                        window.location.href = '@Url.Action("flights", "results" )';
                    }
    }

        onFailed = function (xhr, data) {

            toastr.error("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText, "Response Error");
        }
        const _Body = {
            Authentication: {
                CompanyId: "CFUS",
                CredentialId: "CFUS",
                CredentialPassword: "1",
                CredentialType: "LIVE"
            },
            TypeOfTrip: "<%=data.jType%>",
            Segments:[
                {
                    Origin:"<%=data.Origin%>",
                    Destination:"<%=data.Destination%>",
                    DepartureDate:moment('<%=data.Departure%>').format('DD/MM/YYYY'),
                    DepartureTime:"00:01",
                    DepartureTimeTo:"23:59",
                    ClassOfService: null

                }
            ],
            PaxDetail:{
                Adults:parseInt("<%=data.Adults%>"),
                Child:parseInt("<%=data.Childs%>"),
                Infants:parseInt( "<%=data.Infants%>"),
            },
            Flexi: 0,
            Direct: 3,
            ClassOfService:"<%=data.ClassOfService%>",
            Airlines:[""],
            FareFamily:null,
            TravelType:null,
            RefundableOnly: "false",
            SearchId:""
        }

        $(document).ready(function () {
            let url 
            if("<%=data.jType%>" !== 'Return') {
                url=`${window.location.origin}/flight/result?Origin=<%=data.Origin%>&Destination=<%=data.Destination%>&Adults=<%=data.Adults%>&Childs=<%=data.Childs%>&Infants=<%=data.Infants%>&Departure=<%=data.Departure%>&jType=<%=data.jType%>&ClassOfService=<%=data.ClassOfService%>`
            } else {
                url = `${window.location.origin}/flight/result?Origin=<%=data.Origin%>&Destination=<%=data.Destination%>&Adults=<%=data.Adults%>&Childs=<%=data.Childs%>&Infants=<%=data.Infants%>&Departure=<%=data.Departure%>&jType=<%=data.jType%>&ClassOfService=<%=data.ClassOfService%>&ReturnDate=<%=data.ReturnDate%>`
            }
            window.setTimeout((e)=>{
                window.location.href = url
            }, 1000)

        })

    </script>
    <%- include('../partials/LayoutFooter')%>


